<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE template [
    <!ENTITY odp "http://ec.europa.eu/open-data/ontologies/ec-odp#">
    <!ENTITY dct "http://purl.org/dc/terms/">
    <!ENTITY rndt "http://ritmare.it/rdfdata/rndt#">
    <!ENTITY dcat "http://www.w3.org/ns/dcat#">
]>
<template>
    <!-- SETTINGS -->
    <settings>
        <defaultLanguage>it</defaultLanguage>
        <languageSelection>
            <byItem>ling_md_1</byItem>
        </languageSelection>
        <metadataEndpoint>http://sp7.irea.cnr.it/jboss/edi/</metadataEndpoint>
        <sparqlEndpoint>http://sp7.irea.cnr.it:8891/sparql</sparqlEndpoint>
        <requiresAuthentication>false</requiresAuthentication>
        <requiresValidation>false</requiresValidation>

        <baseDocument>
            <!-- Base Document SensorML version 1.0.1 -->
            <![CDATA[
        <swes:InsertSensor xmlns:sos="http://www.opengis.net/sos/2.0"
    xmlns:sml="http://www.opengis.net/sensorML/1.0.1"
    xmlns:swe="http://www.opengis.net/swe/1.0.1"
    xmlns:tns="http://www.w3.org/2005/08/addressing"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:gco="http://www.isotc211.org/2005/gco"
    xmlns:gss="http://www.isotc211.org/2005/gss"
    xmlns:gmd="http://www.isotc211.org/2005/gmd"
    xmlns:gml="http://www.opengis.net/gml"
    xmlns:swes="http://www.opengis.net/swes/2.0"
    xmlns:om="http://www.opengis.net/om/2.0"
    xmlns:ows="http://www.opengis.net/ows/1.1"
    xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
    xmlns:gsr="http://www.isotc211.org/2005/gsr"
    xmlns:gts="http://www.isotc211.org/2005/gts"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.opengis.net/sos/2.0/ http://schemas.opengis.net/sos/2.0/sosInsertSensor.xsd http://www.opengis.net/swes/2.0 http://schemas.opengis.net/swes/2.0/swes.xsd" version="2.0.0" service="SOS">
    <swes:procedureDescriptionFormat>http://www.opengis.net/sensorML/1.0.1</swes:procedureDescriptionFormat>
    <swes:procedureDescription>
        <!-- Created By: Alessandro Oggioni & Paolo Tagliolato - CNR IREA in Milano - 2014-02-24T08:00:00Z -->
        <!-- Licence CC By SA 3.0  http://creativecommon.org/licences/by-SA/3.0 -->
        <sml:SensorML version="1.0.1">
        ]]>
        </baseDocument>

        <xsltChain>
            <xslt>http://sp7.irea.cnr.it/jboss/MDService/rest/stylesheet_1.xsl?version=1.00</xslt>
        </xsltChain>
    </settings>
    <endpointTypes>
        <endpointType>
            <id>virtuoso</id>
            <method>GET</method>
            <queryParameter>query</queryParameter>
            <parameters>
                <format>application/sparql-results+json</format>
                <save>display</save>
                <fname>undefined</fname>
            </parameters>
        </endpointType>
        <endpointType>
            <id>sparqlCNR</id>
            <method>GET</method>
            <queryParameter>query</queryParameter>
            <parameters>
                <format>application/json</format>
            </parameters>
        </endpointType>
        <endpointType>
            <id>sparqlCSIRO</id>
            <method>GET</method>
            <queryParameter>query</queryParameter>
            <parameters>
                <format>application/json</format>
            </parameters>
        </endpointType>
        <endpointType>
            <id>fuseki</id>
            <method>GET</method>
            <queryParameter>query</queryParameter>
            <parameters>
                <output>json</output>
            </parameters>
        </endpointType>
    </endpointTypes>
    <datasources>
        <datasource>
            <id>charsets</id>
            <uri>http://www.rndt.gov.it/codelists/MD_CharacterSetCode/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
        </datasource>
        <datasource>
            <id>languages</id>
            <uri>http://inspire-registry.jrc.ec.europa.eu/registers/Languages/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
            <url>http://sp7.irea.cnr.it:8891/sparql</url>
        </datasource>
        <datasource>
            <id>scopes</id>
            <uri>http://inspire-registry.jrc.ec.europa.eu/registers/Types/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
        </datasource>
        <datasource>
            <id>fixedRoles</id>
            <uri>http://www.rndt.gov.it/codelists/CI_FixedRoleCode/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
        </datasource>
        <datasource>
            <id>referenceSystemCodes</id>
            <uri>http://www.rndt.gov.it/codelists/MD_ReferenceSystemCode/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
        </datasource>
        <datasource>
            <id>dateTypes</id>
            <uri>http://www.rndt.gov.it/codelists/CI_DateTypeCode/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
        </datasource>
        <datasource>
            <id>roleCodes</id>
            <uri>http://www.rndt.gov.it/codelists/CI_RoleCode/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
        </datasource>
        <datasource>
            <id>presentationForms</id>
            <uri>http://www.rndt.gov.it/codelists/CI_PresentationFormCode/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
        </datasource>
        <datasource>
            <id>person</id>
            <singleton>false</singleton>
            <endpointType>virtuoso</endpointType>
            <query>
                <![CDATA[
          PREFIX ns: <http://www.w3.org/2006/vcard/ns#>
          SELECT DISTINCT ?c ?l
          FROM <http://ritmare.it/rdfdata/project>
          WHERE {
            ?c rdf:type foaf:Person .
            ?c ns:email ?l .
            ?c ns:org ?o .
            FILTER( REGEX( STR(?l), "$search_param", "i") )
          }
          ORDER BY ASC(?l)
        ]]>
            </query>
            <searchItem>md_resp_1</searchItem>
            <type> sparql </type>
        </datasource>
        <!--
    <datasource>
      <id>person</id>
      <singleton>false</singleton>
      <endpointType>sparqlCSIRO</endpointType>
      <url>http://registry.it.csiro.au/ui/sparql-form</url>
      <query>
        <![CDATA[
          PREFIX ns: <http://www.w3.org/2006/vcard/ns#>
          SELECT DISTINCT ?c ?l
          WHERE {
            ?c rdf:type foaf:Person .
            ?c foaf:name ?l .
            FILTER( REGEX( STR(?l), "$search_param", "i") )
          }
          ORDER BY ASC(?l)
        ]]>
      </query>
      <searchItem>md_resp_1</searchItem>
      <type>
        sparql
      </type>
    </datasource>
    -->
        <!--
    <datasource>
      <id>person</id>
      <singleton>false</singleton>
      <endpointType>sparqlCNR</endpointType>
      <url>http://data.cnr.it/sparql-proxy/</url>
      <query>
        <![CDATA[
          PREFIX persone: <http://www.cnr.it/ontology/cnr/persone.owl#>
          PREFIX suddivisioni:	<http://www.cnr.it/ontology/cnr/suddivisioni.owl#> 
          PREFIX localizzazione:	<http://www.cnr.it/ontology/cnr/localizzazione.owl#>
          SELECT DISTINCT ?c ?l
          WHERE {
            ?c rdf:type persone:Persona .
            ?c rdfs:label ?l .
            ?c suddivisioni:afferisceA ?i . 
            FILTER( REGEX( STR(?l), "$search_param", "i") AND LANG(?l) = 'it' )
          }
          ORDER BY ASC(?l)
        ]]>
      </query>
      <searchItem>md_resp_1</searchItem>
      <type>
        sparql
      </type>
    </datasource>
    -->
        <datasource>
            <id>personS</id>
            <singleton>true</singleton>
            <endpointType>virtuoso</endpointType>
            <query>
                <![CDATA[
          PREFIX vcard: <http://www.w3.org/2006/vcard/ns#>
          SELECT ?inst ?home
          FROM <http://ritmare.it/rdfdata/project>
          WHERE {
            <$search_param> vcard:org ?o.
            ?o foaf:name ?inst .
            # ?o foaf:homepage ?home .
            FILTER(LANG(?inst)='it')
          }
        ]]>
            </query>
            <triggerItem>md_resp_1_uri</triggerItem>
            <type> sparql </type>
        </datasource>
        <!--
    <datasource>
      <id>personS</id>
      <singleton>true</singleton>
      <query>
        <![CDATA[
          PREFIX persone:         <http://www.cnr.it/ontology/cnr/persone.owl#>
          PREFIX suddivisioni:    <http://www.cnr.it/ontology/cnr/suddivisioni.owl#> 
          PREFIX localizzazione:  <http://www.cnr.it/ontology/cnr/localizzazione.owl#>
          SELECT ?inst ?home
          FROM <http://ritmare.it/rdfdata/project>
          WHERE {
            <$search_param> suddivisioni:afferisceA ?o .
            ?o foaf:name ?inst .
            ?o foaf:homepage ?home .
            FILTER(LANG(?inst)='it')
          }
        ]]>
      </query>
      <triggerItem>md_resp_1_uri</triggerItem>
      <endpointType>sparqlCNR</endpointType>
      <type>
        sparql
      </type>
    </datasource> 
    -->
        <datasource>
            <id>personS_2</id>
            <singleton>true</singleton>
            <query>
                <![CDATA[
          PREFIX vcard: <http://www.w3.org/2006/vcard/ns#>
          SELECT ?inst ?home
          FROM <http://ritmare.it/rdfdata/project>
          WHERE {
            <$search_param> vcard:org ?o.
            ?o foaf:name ?inst .
            # ?o foaf:homepage ?home .
            FILTER(LANG(?inst)='it')
          }
        ]]>
            </query>
            <endpointType>virtuoso</endpointType>
            <triggerItem>resp_1_uri</triggerItem>
            <type> sparql </type>
        </datasource>
        <datasource>
            <id>personS_3</id>
            <singleton>true</singleton>
            <endpointType>virtuoso</endpointType>
            <query>
                <![CDATA[
          PREFIX vcard: <http://www.w3.org/2006/vcard/ns#>
          SELECT ?inst ?home
          FROM <http://ritmare.it/rdfdata/project>
          WHERE {
            <$search_param> vcard:org ?o.
            ?o foaf:name ?inst .
            # ?o foaf:homepage ?home .
            FILTER(LANG(?inst)='it')
          }
        ]]>
            </query>
            <triggerItem>pdc_1_uri</triggerItem>
            <type> sparql </type>
        </datasource>
        <datasource>
            <id>personS_4</id>
            <singleton>true</singleton>
            <endpointType>virtuoso</endpointType>
            <query>
                <![CDATA[
          PREFIX vcard: <http://www.w3.org/2006/vcard/ns#>
          SELECT ?inst ?home
          FROM <http://ritmare.it/rdfdata/project>
          WHERE {
            <$search_param> vcard:org ?o.
            ?o foaf:name ?inst .
            # ?o foaf:homepage ?home .
            FILTER(LANG(?inst)='it')
          }
        ]]>
            </query>
            <triggerItem>distr_1_uri</triggerItem>
            <type> sparql </type>
        </datasource>
        <datasource>
            <id>updateFreq</id>
            <uri>http://www.rndt.gov.it/codelists/MD_MaintenanceFrequencyCode/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
        </datasource>
        <datasource>
            <id>inspireTheme</id>
            <uri>http://inspire-registry.jrc.ec.europa.eu/registers/Themes/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
        </datasource>

        <datasource>
            <id>keywordFromContrVoc</id>
            <singleton>false</singleton>
            <query>
                <![CDATA[
        PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
        PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
        SELECT ?c ?l
        WHERE {
          ?c rdf:type skos:Concept .
          OPTIONAL {
            ?c skos:prefLabel ?l .
            FILTER( LANG(?l) = "en")
          }
          FILTER( REGEX( STR(?l), "$search_param", "i") )
        }
        ORDER BY ASC(?l) ASC(?a)
        ]]>
            </query>
            <searchItem>keyw_voc_contr_1</searchItem>
            <url>http://vocab.nerc.ac.uk/sparql/sparql</url>
            <endpointType>fuseki</endpointType>
            <type> sparql </type>
        </datasource>
        <!--
    <datasource>
      <id>keywordFromContrVoc</id>
      <singleton>false</singleton>
      <query>
        <![CDATA[
        PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
        SELECT ?c ?l ?a
        FROM <http://ritmare.it/rdfdata/reference>
        WHERE {
          ?c rdf:type skos:Concept .
          OPTIONAL {
            ?c skos:prefLabel ?l .
            FILTER( LANG(?l) = "en")
          }
          OPTIONAL {
            ?c skos:prefLabel ?a .
            FILTER( LANG(?a) = "it")
          }
          FILTER( REGEX( STR(?l), "$search_param", "i") || REGEX( STR(?a), "$search_param", "i") )
        }
        ORDER BY ASC(?l) ASC(?a)
        ]]>
      </query>
      <searchItem>keyw_voc_contr_1</searchItem>
      <endpointType>virtuoso</endpointType>
      <type>
        sparql
      </type>
    </datasource>
    -->
        <datasource>
            <id>contrVocSpecs</id>
            <singleton>true</singleton>
            <query>
                <![CDATA[
        PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
        SELECT ?c ?l ?date
        FROM <http://ritmare.it/rdfdata/reference>
        WHERE {
          <$search_param> skos:inScheme ?c .
          ?c skos:prefLabel ?l .
          ?c dct:issued ?date .
          FILTER( LANG(?l) = "en")
        }
        ]]>
            </query>
            <triggerItem>keyw_voc_contr_1_uri</triggerItem>
            <endpointType>virtuoso</endpointType>
            <type> sparql </type>
        </datasource>
        <datasource>
            <id>paramOss</id>
            <singleton>false</singleton>
            <query>
                <![CDATA[
          PREFIX skos: <http://www.w3.org/2004/02/skos/core#> 
          SELECT ?c ?l ?a
          FROM <http://ritmare.it/rdfdata/parameters>
          WHERE { 
            ?c rdf:type skos:Concept.
            OPTIONAL {
            ?c skos:prefLabel ?l.
            FILTER( LANG(?l) = "en")
            }
            OPTIONAL {
            ?c skos:prefLabel ?a.
            FILTER( LANG(?a) = "it")
            }
            FILTER( REGEX( STR(?l), "$search_param", "i") || REGEX( STR(?a), "$search_param", "i") )
            }
          ORDER BY ASC(?l) ASC(?a) 
        ]]>
            </query>
            <triggerItem>par_oss_1</triggerItem>
            <endpointType>virtuoso</endpointType>
            <type> sparql </type>
        </datasource>
        <datasource>
            <id>restrictionCode</id>
            <uri>http://www.rndt.gov.it/codelists/MD_RestrictionCode/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
        </datasource>
        <datasource>
            <id>classificationCode</id>
            <uri>http://www.rndt.gov.it/codelists/MD_ClassificationCode/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
        </datasource>
        <datasource>
            <id>representationTypeCode</id>
            <uri>http://www.rndt.gov.it/codelists/MD_SpatialRepresentationTypeCode/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
        </datasource>
        <datasource>
            <id>topicCategories</id>
            <uri>http://inspire-registry.jrc.ec.europa.eu/registers/TopicCategories/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
        </datasource>
        <datasource>
            <id>conformity</id>
            <uri>http://www.rndt.gov.it/codelists/conformity/items</uri>
            <endpointType>virtuoso</endpointType>
            <type>virtuosoCodelist</type>
        </datasource>
    </datasources>

</template>
