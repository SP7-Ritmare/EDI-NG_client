<!DOCTYPE template [
    <!ENTITY odp "http://ec.europa.eu/open-data/ontologies/ec-odp#">
    <!ENTITY dct "http://purl.org/dc/terms/">
    <!ENTITY rndt "http://ritmare.it/rdfdata/rndt#">
    <!ENTITY dcat "http://www.w3.org/ns/dcat#">
]>
<template>
  <settings>
    <defaultLanguage>it</defaultLanguage>
    <languageSelection>
      <byItem>ling_md_1</byItem>
    </languageSelection>
    <requiresAuthentication>true</requiresAuthentication>
    <metadataEndpoint>https://sp7.irea.cnr.it/jboss/edi/</metadataEndpoint>
    <sparqlEndpoint>http://sp7.irea.cnr.it:8891/sparql</sparqlEndpoint>
    <requiresValidation>true</requiresValidation>
    <baseDocument>
      <![CDATA[
        <gmd:MD_Metadata
            xsi:schemaLocation="http://www.isotc211.org/2005/gmd
            http://schemas.opengis.net/iso/19139/20060504/gmd/gmd.xsd"
            xmlns:gmd="http://www.isotc211.org/2005/gmd" xmlns:gco="http://www.isotc211.org/2005/gco"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:gml="http://www.opengis.net/gml"
            xmlns:xlink="http://www.w3.org/1999/xlink">
    
        </gmd:MD_Metadata>
      ]]>
    </baseDocument>
    <xsltChain>
      <xslt>http://sp7.irea.cnr.it/jboss/MDService/rest/stylesheet_1.xsl?version=1.00</xslt>
    </xsltChain>
  </settings>
  <datasources>
    <datasource>
      <id>charsets</id>
      <uri>http://www.rndt.gov.it/codelists/MD_CharacterSetCode/items</uri>
      <type>virtuosoCodelist</type>
    </datasource>
    <datasource>
      <id>languages</id>
      <uri>http://inspire-registry.jrc.ec.europa.eu/registers/Languages/items</uri>
      <type>virtuosoCodelist</type>
      <url>http://sp7.irea.cnr.it:8891/sparql</url>
    </datasource>
    <datasource>
      <id>scopes</id>
      <uri>http://inspire-registry.jrc.ec.europa.eu/registers/Types/items</uri>
      <type>virtuosoCodelist</type>
    </datasource>
    <datasource>
      <id>fixedRoles</id>
      <uri>http://www.rndt.gov.it/codelists/CI_FixedRoleCode/items</uri>
      <type>virtuosoCodelist</type>
    </datasource>
    <datasource>
      <id>referenceSystemCodes</id>
      <uri>http://www.rndt.gov.it/codelists/MD_ReferenceSystemCode/items</uri>
      <type>virtuosoCodelist</type>
    </datasource>
    <datasource>
      <id>dateTypes</id>
      <uri>http://www.rndt.gov.it/codelists/CI_DateTypeCode/items</uri>
      <type>virtuosoCodelist</type>
    </datasource>
    <datasource>
      <id>roleCodes</id>
      <uri>http://www.rndt.gov.it/codelists/CI_RoleCode/items</uri>
      <type>virtuosoCodelist</type>
    </datasource>
    <datasource>
      <id>presentationForms</id>
      <uri>http://www.rndt.gov.it/codelists/CI_PresentationFormCode/items</uri>
      <query>
        <![CDATA[
            PREFIX ns: <http://www.w3.org/2006/vcard/ns#>
            SELECT ?c ?l ?name ?homepage
            FROM <http://ritmare.it/rdfdata/project>
            WHERE {
              ?c rdf:type foaf:Person.
              ?c ns:email ?l.
              ?c ns:org ?o .
              ?o rdfs:label ?name .
              ?o foaf:homepage ?homepage.
              FILTER( REGEX( STR(?l), "$search_param", "i") )
            }
            ORDER BY ASC(?l) ASC(?name)
        ]]>
      </query>
      <type>virtuosoCodelist</type>
    </datasource>
    <datasource>
      <id>person</id>
      <url>http://sp7.irea.cnr.it:8891/sparql</url>
      <singleton>false</singleton>
      <query>
        <![CDATA[
            PREFIX ns: <http://www.w3.org/2006/vcard/ns#>
            SELECT ?c ?l
            FROM <http://ritmare.it/rdfdata/project>
            WHERE {
              ?c rdf:type foaf:Person.
              ?c ns:email ?l.
              ?c ns:org ?o .
              FILTER( REGEX( STR(?l), "$search_param", "i") )
            }
            ORDER BY ASC(?l)
        ]]>
      </query>
      <searchItem>resp_md_1</searchItem>
      <type>
        sparql
      </type>
    </datasource>
    <datasource>
      <id>personS</id>
      <singleton>true</singleton>
      <query>
        <![CDATA[
            PREFIX vcard: <http://www.w3.org/2006/vcard/ns#>
            SELECT ?inst ?home
            FROM <http://ritmare.it/rdfdata/project>
            WHERE {
              <$search_param> vcard:org ?o.
              ?o foaf:name ?inst .
              ?o foaf:homepage ?home .
              FILTER(LANG(?inst)='it')
            }
        ]]>
      </query>
      <triggerItem>resp_md_1_uri</triggerItem>
      <type>
        sparql
      </type>
    </datasource>
    <datasource>
      <id>updateFreq</id>
      <uri>http://www.rndt.gov.it/codelists/MD_MaintenanceFrequencyCode/items</uri>
      <type>virtuosoCodelist</type>
    </datasource>
    <datasource>
      <id>inspireTheme</id>
      <uri>http://inspire-registry.jrc.ec.europa.eu/registers/Themes/items</uri>
      <type>virtuosoCodelist</type>
    </datasource>
    <datasource>
      <id>keywordFromContrVoc</id>
      <singleton>false</singleton>
      <query>
        <![CDATA[
        PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
        SELECT ?c ?l ?a
        FROM <http://ritmare.it/rdfdata/reference>
        WHERE {
          ?c rdf:type skos:Concept.
          OPTIONAL {
            ?c skos:prefLabel ?l.
            FILTER( LANG(?l) = "en")
          }
          OPTIONAL {
            ?c skos:prefLabel ?a.
            FILTER( LANG(?a) = "it")
          }
          FILTER( REGEX( STR(?l), "$search_param", "i") || REGEX( STR(?a), "$search_param", "i") )
        }
        ORDER BY ASC(?l) ASC(?a)
        ]]>
      </query>
      <type>
        sparql
      </type>
    </datasource>
    <datasource>
      <id>contrVocSpecs</id>
      <singleton>true</singleton>
      <query>
        <![CDATA[
        PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
        SELECT ?c ?l
        FROM <http://ritmare.it/rdfdata/reference>
        WHERE {
          <$search_param> skos:inScheme ?c.
          ?c skos:prefLabel ?l.
          FILTER( LANG(?l) = "en")
        }
        ]]>
      </query>
      <triggerItem>resp_md_1_uri</triggerItem>
      <type>
        sparql
      </type>
    </datasource>
  </datasources>
  <group>
    <id>info_md</id>
    <label xml:lang="en">Information on metadata</label>
    <label xml:lang="it">Informazioni sui metadati</label>
    <!--Identificatore del file: -->
    <element>
      <id>id_md</id>
      <label xml:lang="en">File identifier</label>
      <label xml:lang="it">Identificatore del file</label>
      <isMandatory>forAll</isMandatory>
      <isMultiple>false</isMultiple>
      <hasRoot>/gmd:MD_Metadata/gmd:fileIdentifier</hasRoot>
      <produces>
        <item>
          <hasIndex>1</hasIndex>
          <hasPath>/gmd:MD_Metadata/gmd:fileIdentifier/gco:CharacterString</hasPath>
          <isFixed>false</isFixed>
          <hasDatatype>string</hasDatatype>
          <hasValue>Морски</hasValue>
          <defaultValue>Морски</defaultValue>
          <queryStringParameter>uid</queryStringParameter>
        </item>
        <item>
          <hasIndex>2</hasIndex>
          <hasPath>/gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification/gmd:citation/gmd:CI_Citation/gmd:identifier/gmd:MD_Identifier/gmd:code/gco:CharacterString</hasPath>
          <isFixed>true</isFixed>
          <hasDatatype>URN</hasDatatype>
          <hasValue>auto</hasValue>
        </item>
        <item>
          <hasIndex>3</hasIndex>
          <hasPath>/gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification/gmd:citation/gmd:CI_Citation/gmd:identifier/gmd:MD_Identifier/gmd:code/gco:Pippo</hasPath>
          <isFixed>false</isFixed>
          <hasDatatype>string</hasDatatype>
          <show>label</show>
          <hasValue>ERMES</hasValue>
        </item>

      </produces>
    </element>
  </group>

</template>