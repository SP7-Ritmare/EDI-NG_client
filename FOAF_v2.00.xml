<?xml version="1.0" encoding="UTF-8"?>
<template xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <settings>
    <!--indica l'item in cui reperire la lingua -->  
    <languageSelection>
      <element>ling_md</element>
      <itemIndex>1</itemIndex>
    </languageSelection>
    <defaultLanguage>it</defaultLanguage>
    <requiresAuthentication>true</requiresAuthentication>
    <metadataEndpoint>https://adamassoft.it/jbossTest/MDService/</metadataEndpoint>
    <requiresValidation>true</requiresValidation>
  </settings>  
  <datasources>
    <datasource>
      <id>countries</id>
      <singleton>false</singleton>
      <url>http://10.0.0.20:8890/sparql</url>
      <query>
        <![CDATA[
            PREFIX jur: <http://sweet.jpl.nasa.gov/2.3/humanJurisdiction.owl#>
            SELECT ?c ?l
            FROM <http://ritmare.it/rdfdata/countries>
            WHERE {
              ?c rdf:type jur:Country .
              ?c foaf:name ?l .
              FILTER( LANG(?l) = "en" )
            }
            ORDER BY ASC(?l)
        ]]>
      </query>
      <type>
        sparql
      </type>
    </datasource>
    <datasource>
      <id>address</id>
      <singleton>true</singleton>
      <url>http://10.0.0.20:8890/sparql</url>
      <query>
        <![CDATA[
            PREFIX  vcard: <http://www.w3.org/2006/vcard/ns#>
            SELECT ?str ?loc ?cap ?cou
            FROM <http://ritmare.it/rdfdata/project>
            WHERE {
              {
                OPTIONAL {
                  <$search_param> vcard:hasAddress ?a .
                  ?a vcard:street-address ?str .
                  ?a vcard:locality ?loc .
                  ?a vcard:postal-code ?cap .
                  ?a vcard:country-name ?cou .
                }
              } UNION {
                <$search_param> vcard:org ?org . 
                ?org vcard:hasAddress ?b .
                OPTIONAL {
                  ?b vcard:street-address ?str .
                  ?b vcard:locality ?loc .
                  ?b vcard:postal-code ?cap .
                  ?b vcard:country-name ?cou .
                }                
              }
            }
            LIMIT 1
        ]]>
      </query>
      <triggerItem>dati_personali_1_uri</triggerItem>
      <type>
        sparql
      </type>
    </datasource>
    <datasource>
      <id>institutes</id>
      <singleton>false</singleton>
      <url>http://10.0.0.20:8890/sparql</url>
      <query>
        <![CDATA[
            PREFIX  vcard: <http://www.w3.org/2006/vcard/ns#>
            SELECT ?c ?l
            FROM <http://ritmare.it/rdfdata/project>
            WHERE {
              ?c rdf:type foaf:Organization .
              ?c foaf:name ?l .
              FILTER( LANG(?l) = "zxx" )
            }
            ORDER BY ASC(?l)
        ]]>
      </query>
      <type>
        sparql
      </type>
    </datasource>
    <datasource>
      <id>person</id>
      <singleton>false</singleton>
      <url>http://10.0.0.20:8890/sparql</url>
      <query>
        <![CDATA[
            SELECT ?c ?l
            FROM <http://ritmare.it/rdfdata/project>
            WHERE {
              ?c rdf:type foaf:Person.
              ?c foaf:fullName ?l.
              FILTER( REGEX( STR(?l), "$search_param", "i") )
            }
            ORDER BY ASC(?l)
        ]]>
      </query>
      <searchItem>dati_personali_1</searchItem>
      <type>
        sparql
      </type>
    </datasource>
    <datasource>
      <id>personS</id>
      <singleton>true</singleton>
      <url>http://10.0.0.20:8890/sparql</url>
      <query>
        <![CDATA[
            PREFIX  vcard: <http://www.w3.org/2006/vcard/ns#>
            SELECT ?gName ?fName ?email ?phone ?org
            FROM <http://ritmare.it/rdfdata/project>
            WHERE {
              OPTIONAL {
                <$search_param> foaf:givenName ?gName .
              }
              OPTIONAL {
                <$search_param> foaf:familyName ?fName .
              }
              OPTIONAL {
                <$search_param> vcard:email ?email .
              }
              OPTIONAL {
                <$search_param> foaf:phone ?phone .
              }
              OPTIONAL {
                <$search_param> vcard:org ?org .
              }
            }
        ]]>
      </query>
      <triggerItem>dati_personali_1_uri</triggerItem>
      <type>
        sparql
      </type>
    </datasource>
    <datasource>
      <id>research_areas</id>
      <uri>http://ritmare.it/rdfdata/thesauri/domains/all</uri>
      <type>virtuosoCodelist</type>
    </datasource>
    <datasource>
      <id>keywords</id>
      <singleton>false</singleton>
      <url>http://10.0.0.10:8890/sparql</url>
      <query>    
            <![CDATA[
              SELECT ?c ?l
              FROM <http://ritmare.it/rdfdata/reference>
              WHERE {
                ?c rdf:type skos:Concept .
                ?c skos:prefLabel ?l .
                FILTER( REGEX( STR(?l), "$search_param", "i") )
              }
              ORDER BY ASC(?l)
            ]]>
      </query>
      <type>
        sparql
      </type>
    </datasource>    
    <datasource>
      <id>networks</id>
      <uri>http://ritmare.it/rdfdata/thesauri/accountServices</uri>
      <type>virtuosoCodelist</type>
    </datasource>
    <datasource>
      <id>knows</id>
      <singleton>false</singleton>
      <url>http://10.0.0.20:8890/sparql</url>
      <query>
        <![CDATA[
            PREFIX  vcard: <http://www.w3.org/2006/vcard/ns#>
            SELECT ?c ?l
            FROM <http://ritmare.it/rdfdata/project>
            WHERE {
              OPTIONAL {
                <$search_param> foaf:knows ?c .
                ?c foaf:fullName ?l .
              }
            }
            LIMIT 1
        ]]>
      </query>
      <triggerItem>dati_personali_1_uri</triggerItem>
      <type>
        sparql
      </type>
    </datasource>
  </datasources>    
  <group>
    <id>external_accounts</id>
    <label xml:lang="it">Account esterni</label>
    <label xml:lang="en">External accounts</label>
            <![CDATA[
              SELECT ?c ?l
              FROM <http://ritmare.it/rdfdata/reference>
              WHERE {
                ?c rdf:type skos:Concept .
                ?c skos:prefLabel ?l .
                FILTER( REGEX( STR(?l), "$search_param", "i") )
              }
              ORDER BY ASC(?l)
            ]]>
    <element>
      <id>ref_acc</id>
      <label xml:lang="it">Estremi account</label>
      <label xml:lang="en">Account details</label>
      <isMandatory>NA</isMandatory>
      <isMultiple>true</isMultiple>
      <hasRoot>/rdf:RDF/foaf:Person</hasRoot>
      <produces>
        <item>
          <hasIndex>1</hasIndex>
          <label xml:lang="it">ID utente</label>
          <label xml:lang="en">User ID</label>
          <hasPath>/rdf:RDF/foaf:Person/foaf:account/foaf:accountName</hasPath>
          <isFixed>false</isFixed>
          <id>foaf:accountName</id>
          <hasDatatype>string</hasDatatype> 
          <hasValue>user-defined</hasValue>
        </item>
        <item>
          <hasIndex>2</hasIndex>
          <label xml:lang="it">Rete sociale</label>
          <label xml:lang="en">Social Network</label>
          <hasPath>/rdf:RDF/foaf:Person/foaf:account/foaf:accountServiceHomepage/@rdf:resource</hasPath>
          <isFixed>false</isFixed>
          <id>foaf:accountServiceHomepage</id>
          <hasDatatype>code</hasDatatype>
          <datasource>networks</datasource>
          <show>combobox</show>
        </item>
      </produces>
    </element>
  </group>
  <group>
    <id>anagrafica</id>
    <label xml:lang="it">Anagrafica</label>
    <label xml:lang="en">Vital statistics</label>
    <element>
      <id>dati_personali</id>
      <label xml:lang="it">Dati personali</label>
      <label xml:lang="en">Personal data</label>
      <isMandatory>forAll</isMandatory>
      <isMultiple>false</isMultiple>
      <hasRoot>/rdf:RDF/foaf:Person</hasRoot>
      <produces>
        <item>
          <hasIndex>1</hasIndex>
          <label xml:lang="it">Utente</label>
          <label xml:lang="en">User</label>
          <hasPath>/rdf:RDF/foaf:Person/@rdf:about</hasPath>
          <isFixed>false</isFixed>
          <id>rdf:about</id>
          <datasource>person</datasource>
          <hasDatatype>autoCompletion</hasDatatype>
          <isLanguageNeutral>true</isLanguageNeutral>
        </item>
        <item>
          <hasIndex>2</hasIndex>
          <label xml:lang="it">Nome</label>
          <label xml:lang="en">First name</label>
          <hasPath>/rdf:RDF/foaf:Person/foaf:firstName</hasPath>
          <isFixed>false</isFixed>
          <datasource>personS</datasource>
          <hasDatatype>select</hasDatatype>
          <field>gName</field>
        </item>
        <item>
          <hasIndex>3</hasIndex>
          <label xml:lang="it">Cognome</label>
          <label xml:lang="en">Family name</label>
          <hasPath>/rdf:RDF/foaf:Person/foaf:familyName</hasPath>
          <isFixed>false</isFixed>
          <datasource>personS</datasource>
          <hasDatatype>select</hasDatatype>
          <field>fName</field>
        </item>
        <item>
          <hasIndex>4</hasIndex>
          <label xml:lang="it">Nome completo</label>
          <label xml:lang="en">Full name</label>
          <hasPath>/rdf:RDF/foaf:Person/foaf:fullName</hasPath>
          <isFixed>true</isFixed>
          <datasource>person</datasource>
          <hasDatatype>function</hasDatatype>
          <show>hidden</show>
          <hasValue>concat(foaf:familyName/text(), ' ', foaf:firstName/text())</hasValue>
        </item>
        <item>
          <label xml:lang="it">Indirizzo e-mail</label>
          <label xml:lang="en">E-mail address</label>
          <hasIndex>5</hasIndex>
          <hasPath>/rdf:RDF/foaf:Person/vcard:email/@rdf:resource</hasPath>
          <isFixed>false</isFixed>
          <datasource>personS</datasource>
          <hasDatatype>select</hasDatatype>
          <field>email</field>
        </item>
        <item>
          <label xml:lang="it">Telefono</label>
          <label xml:lang="en">Phone</label>
          <hasIndex>6</hasIndex>
          <hasPath>/rdf:RDF/foaf:Person/foaf:phone/@rdf:resource</hasPath>
          <isFixed>false</isFixed>
          <datasource>personS</datasource>
          <hasDatatype>select</hasDatatype>
          <field>phone</field>
        </item>
        <item>
          <label xml:lang="it">URI istituto</label>
          <label xml:lang="en">Institute URI</label>
          <hasIndex>7</hasIndex>
          <hasPath></hasPath>
          <isFixed>false</isFixed>
          <datasource>personS</datasource>
          <hasDatatype>select</hasDatatype>
          <show>hidden</show>
          <field>org</field>
        </item>
        <item>
          <label xml:lang="it">Istituto</label>
          <label xml:lang="en">Institute</label>
          <hasIndex>8</hasIndex>
          <hasPath>/rdf:RDF/foaf:Person/vcard:org/@rdf:resource</hasPath>
          <isFixed>false</isFixed>
          <show>combobox</show>
          <datasource>institutes</datasource>
          <hasDatatype>copy</hasDatatype>
          <itemId>dati_personali_7</itemId>
        </item>
      </produces>
    </element>
    <element>
      <id>address</id>
      <label xml:lang="it">Indirizzo</label>
      <label xml:lang="en">Address</label>
      <isMandatory>forAll</isMandatory>
      <isMultiple>false</isMultiple>
      <hasRoot>/foaf:Person/vcard:hasAddress</hasRoot>
      <produces>
        <item>
          <label xml:lang="it">Nome via</label>
          <label xml:lang="en">Street name</label>
          <hasIndex>1</hasIndex>
          <hasPath>/foaf:Person/vcard:hasAddress/vcard:street-address</hasPath>
          <isFixed>false</isFixed>
          <datasource>address</datasource>
          <hasDatatype>select</hasDatatype>
          <field>str</field>
        </item>
        <item>
          <label xml:lang="it">Localit&#224;</label>
          <label xml:lang="en">Locality</label>
          <hasIndex>2</hasIndex>
          <hasPath>/foaf:Person/vcard:hasAddress/vcard:locality</hasPath>
          <isFixed>false</isFixed>
          <datasource>address</datasource>
          <hasDatatype>select</hasDatatype>
          <field>loc</field>
        </item>      
        <item>
          <label xml:lang="it">C.A.P.</label>
          <label xml:lang="en">Postal code</label>
          <hasIndex>3</hasIndex>
          <hasPath>/foaf:Person/vcard:hasAddress/vcard:postal-code</hasPath>
          <isFixed>false</isFixed>
          <datasource>address</datasource>
          <hasDatatype>select</hasDatatype>
          <field>cap</field>
        </item>
        <item>
          <label xml:lang="it">URI nazione</label>
          <label xml:lang="en">Country URI</label>
          <hasIndex>4</hasIndex>
          <hasPath></hasPath>
          <isFixed>false</isFixed>
          <datasource>address</datasource>
          <hasDatatype>select</hasDatatype>
          <show>hidden</show>
          <field>cou</field>
        </item>        
        <item>
          <label xml:lang="it">Nazione</label>
          <label xml:lang="en">Country</label>
          <hasIndex>5</hasIndex>
          <hasPath>/foaf:Person/vcard:hasAddress/vcard:country</hasPath>
          <isFixed>false</isFixed>
          <show>combobox</show>
          <datasource>countries</datasource>
          <hasDatatype>copy</hasDatatype>
          <itemId>address_4</itemId>
        </item>      
      </produces>
    </element>
  </group>
  <group>
    <id>ambiti</id>
    <label xml:lang="it">Ambiti di ricerca</label>
    <label xml:lang="en">Research areas</label>
    <element>
      <id>ambito</id>
      <label xml:lang="it">Ambito</label>
      <label xml:lang="en">Areas</label>
      <isMandatory>forAll</isMandatory>
      <isMultiple>true</isMultiple>
      <hasRoot>/rdf:RDF/foaf:Person</hasRoot>
      <produces>
        <item>
          <hasIndex>1</hasIndex>
          <hasPath>/rdf:RDF/foaf:Person/foaf:topic-interest/@rdf:resource</hasPath>
          <isFixed>false</isFixed>
          <hasDatatype>code</hasDatatype>
          <datasource>research_areas</datasource>
          <isLanguageNeutral>true</isLanguageNeutral>
          <show>combobox</show>
        </item>
      </produces>
    </element>
    <element>
      <id>keyword</id>
      <label xml:lang="it">Parola chiave</label>
      <label xml:lang="en">Keyword</label>
      <isMandatory>NA</isMandatory>
      <isMultiple>true</isMultiple>
      <hasRoot>/rdf:RDF/foaf:Person</hasRoot>
      <produces>
        <item>
          <hasIndex>1</hasIndex>
          <hasPath>/rdf:RDF/foaf:Person/foaf:topic-interest/@rdf:resource</hasPath>
          <isFixed>false</isFixed>
          <datasource>keywords</datasource>
          <hasDatatype>autoCompletion</hasDatatype>
          <isLanguageNeutral>true</isLanguageNeutral>
        </item>
      </produces>
    </element>        
  </group>
  <group>
    <id>rete</id>
    <label xml:lang="it">Rete sociale</label>
    <label xml:lang="en">Social network</label>
    <element>
      <id>conosce</id>
      <label xml:lang="it">Conosce</label>
      <label xml:lang="en">Knows</label>
      <isMandatory>NA</isMandatory>
      <isMultiple>true</isMultiple>
      <hasRoot>/rdf:RDF/foaf:Person</hasRoot>
      <produces>
        <item>
          <label xml:lang="it">URI persona</label>
          <label xml:lang="en">Person URI</label>
          <hasIndex>1</hasIndex>
          <hasPath></hasPath>
          <isFixed>false</isFixed>
          <datasource>personS</datasource>
          <hasDatatype>select</hasDatatype>
          <show>hidden</show>
          <field>c</field>
        </item>
        <item>
          <hasIndex>2</hasIndex>
          <hasPath>/rdf:RDF/foaf:Person/foaf:knows/@rdf:resource</hasPath>
          <isFixed>false</isFixed>
          <datasource>person</datasource>
          <hasDatatype>copy</hasDatatype>
          <itemId>conosce_1</itemId>
          <isLanguageNeutral>true</isLanguageNeutral>
        </item>
      </produces>
    </element>    
  </group>
</template>
